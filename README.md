# pytest_ui_api_chitai_gorod

# Автоматизация тестирования для проекта «Читай-город» на Python

# Шаги
1. Создать виртуальное окружение: `python - m venv venv`
    - Python должен быть установлен и добавлен в PATH системы.
2. Активировать виртуальное окружение:
    - Для Windows(Command Prompt): `venv\Scripts\activate.bat`
    - Для Windows (PowerShell): `venv\Scripts\Activate.ps1`
    - Для macOS/Linux: `source venv/bin/activate`

3. Склонировать проект с GitHub: `git clone https://github.com/Exesauer/pytest_ui_api_chitai_gorod.git`
4. Установить все необходимые зависимости: `pip install -r requirements.txt`
    > Совет: Если возникнут ошибки, необходимо проверить совместимость версий в requirements.txt и обновить пакеты.
5. Перейти на сайт https://www.chitai-gorod.ru/ и выполнить вход с использованием номера телефона.
6. Заполнить файл с тестовыми данными: test_data.json.
    - "username": "Имя, отображаемое в иконке профиля",
    - "phone": "+7...",
    - "token": "Bearer ... DevTools-Application-Cookies: (access-token)"
    > Примечание: Токен действителен в течение одного часа.  
    Используйте инструменты разработчика в браузере, чтобы получить его.
7. Запустить все тесты: `pytest`
    - только UI-тесты: `pytest ./tests_/tests_ui.py`
    - только API-тесты: `pytest ./tests_/tests_api.py`
    > Совет: Если pytest не установлен: `pip install pytest`
8. Сгенерировать отчет с помощью Allure: `allure generate allure-results --clean -o allure-report`
   > Примечание: Для генерации отчета должен быть установлен Allure.  
    Установку Allure можно найти в официальной документации.
9. Открыть отчет в браузере: `allure open allure-report`

### Возможные проблемы с браузером

Если браузер зависнет в процессе, то можно:

1. Подождать некоторое время.
2. Либо кликнуть на строку с URL и нажать Enter.

>Эта проблема может быть связана с особенностями загрузки динамического контента.

### Примечание по поддерживаемым платформам и устройствам

1. Поддерживаемые платформы  
    Проект был протестирован и оптимизирован для среды Windows.
    > Примечание: При использовании macOS и других систем стоит учитывать возможные проблемы с совместимостью.

2. Возможные проблемы с устройствами  
   При использовании более медленных устройств или при плохом соединении может возникнуть проблема с таймаутом при загрузке страниц в браузере.   
    Настройками тайм-аута можно управлять в файле test_config.ini:

        [ui]
        base_url = https://www.chitai-gorod.ru/
        browser_name = Chrome
        timeout = 4
   
    >Совет: Рекомендуется увеличить значение `timeout`, если заметили, что страницы не успевают загружаться полностью. Например, установите `timeout = 10` для более комфортного выполнения тестов.

### Стек:
- **pytest**: Библиотека для написания и выполнения тестов.
- **selenium**: Инструмент для автоматизации веб-приложений в различных браузерах.
- **webdriver-manager**: Управляет установкой и обновлением драйверов для различных браузеров, автоматизируя этот процесс.
- **requests**: Библиотека для HTTP-запросов, полезна для API-тестов.
- **allure**: Фреймворк для генерации наглядных отчетов Allure на основе тестов Pytest.
- **configparser**: Для работы с конфигурациями проекта, обеспечивает гибкость и удобство настройки тестирования.

### Структура:
- ./tests_ - Тесты
- ./UI - Вспомогательные модули для работы с UI
- ./API - Вспомогательные модули для работы с API
- ./configuration - Провайдер настроек для тестов
    - test_config.ini - Файл с настройками
- ./testdata - Провайдер тестовых данных
    - test_data.json - Файл с данными
- pytest.ini - Файл с настройками pytest

### Полезные ссылки
- [Подсказка по markdown](https://www.markdownguide.org/basic-syntax/)
- [Генератор файла .gitignore](https://www.toptal.com/developers/gitignore)
- [Официальный репозиторий библиотек Python](https://pypi.org/)
- [ConfigParser](https://docs.python.org/3/library/configparser.html)
- [pip freeze](https://pip.pypa.io/en/stable/cli/pip_freeze/)